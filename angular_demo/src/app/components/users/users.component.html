<div class="category border m-2 p-4">
    <h1 class="display-4">Users</h1>

    <div class="form-group col-lg-3">
        <input type="text" class="form-control" placeholder="Search..." [(ngModel)]="filterTerm" autofocus>
      </div>
      <br>
<table class="table table-hover">
    <thead style="background-color:slategray">
        <tr>
           
            <th>User Name</th>
            <th>Role</th>
            
            <th colspan="3">Action</th>

        </tr>
    </thead>
    <tbody>
        <tr *ngFor='let user of users | filter:filterTerm '>
            <td>{{user.username}} </td>
            <td> {{user?.roleFK?.nom}}</td>
            
            
            <td><button class="btn btn-success btn-sm" (click)='openModal(formModal,user)' >Update User</button></td>
            <td><button class="btn btn-info btn-sm" (click)='openModal(roleModal,user)' >Affecter Role</button></td>
            <td><button class="btn btn-danger btn-sm" (click)='deleteUser(user.id)' >delete User</button></td>
            
        </tr>
    </tbody>

</table>
<br>
<br>
<div *ngIf='error' class="alert alert-danger alert-dismissible fade show col-lg-3" role="alert">
    <strong>{{error}}</strong> 
    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
<div *ngIf='success' class="alert alert-success alert-dismissible fade show col-lg-3" role="alert">
    <strong>{{success}}</strong> 
    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>


</div>

<ng-template #formModal>
    <div class="container-fluid">
        <form #updateForm action="javascript:void(0);" (submit)='updateUser(updateForm)' class="p-4 m-3" method="POST">
            <h1 class="display-6">Update User</h1>
            <hr>
            <div class="form-group m-3">
                <label for="name">User Name</label>
                <input id="name" class="form-control" value="{{selectedUser.username}}" type="text" name="username" />
            </div>
            <div class="mt-4 p-2 m-2">
                <button type="submit" class="btn btn-info col-lg-5 ">Update User</button>
            </div>
        </form>


    </div>
</ng-template>
<ng-template #roleModal>
    <div class="container-fluid">
        <form #roleForm action="javascript:void(0);"   (submit)='affecterRole(roleForm)' class="p-4 m-3" method="POST">
            <h1 class="display-6">Affecter Role</h1>
            <hr>
            <div class="form-group m-3">
                <label for="name">Role Name</label>
                <select id="role" class="form-control" name="roleFK">
                    <option *ngFor="let role of roles" value="{{role.idRole}}">{{role.nom}} </option>   
                </select>
            </div>
            <div class="mt-4 p-2 m-2">
                <button type="submit" class="btn btn-info col-lg-5 ">Save Role</button>
            </div>
        </form>


    </div>
</ng-template>